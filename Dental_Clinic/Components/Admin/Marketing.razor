@page "/admin-marketing"
@using Microsoft.AspNetCore.Components.Routing
@using Dental_Clinic.Services
@using Dental_Clinic.Models
@using Microsoft.AspNetCore.Components.Forms
@inject NavigationManager Navigation
@inject DatabaseService DatabaseService
@inject EmailService EmailService
@inject CloudinaryService CloudinaryService
@inject IJSRuntime JSRuntime

<link rel="stylesheet" href="css/AdminMarketing.css">
<link rel="stylesheet" href="css/admindashboard.css" />

<div class="dashboard-page">
    <!-- Top Navigation Bar -->
    <AdminNavBar />

    <!-- Main Content -->
    <main class="dashboard-main main-content">
        <!-- Stats Cards -->
        <div class="stats-grid">
            <div class="stat-card yellow-border">
                <div class="stat-left">
                    <div class="stat-label">Average Rating</div>
                    <div class="stat-value-row">
                        <span class="stat-number">@averageRating.ToString("F1")</span>
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="#fbbf24"
                            xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z" />
                        </svg>
                    </div>
                </div>
                <div class="stat-icon-bg yellow-bg">
                    <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="2"
                        xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"
                            stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                </div>
            </div>

            <div class="stat-card green-border">
                <div class="stat-left">
                    <div class="stat-label">Happy Patients</div>
                    <div class="stat-value-row">
                        <span class="stat-number">@happyPatients</span>
                    </div>
                    <div class="stat-subtitle">4-5 star ratings</div>
                </div>
                <div class="stat-icon-bg green-bg">
                    <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2"
                        xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"
                            stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                </div>
            </div>

            <div class="stat-card blue-border">
                <div class="stat-left">
                    <div class="stat-label">Pending Replies</div>
                    <div class="stat-value-row">
                        <span class="stat-number">@feedbacks.Count(f => !f.IsReplied)</span>
                    </div>
                    <div class="stat-subtitle">Needs response</div>
                </div>
                <div class="stat-icon-bg blue-bg">
                    <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2"
                        xmlns="http://www.w3.org/2000/svg">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" stroke-linecap="round"
                            stroke-linejoin="round" />
                    </svg>
                </div>
            </div>
        </div>

        <!-- Feedback Section -->
        <div class="feedback-section">
            <div class="feedback-header">
                <div class="tabs">
                    <button class="tab @(activeTab == "inbox" ? "active" : "")" @onclick='() => SetActiveTab("inbox")'>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <polyline points="22 12 16 12 14 15 10 15 8 12 2 12" stroke-linecap="round"
                                stroke-linejoin="round" />
                            <path
                                d="M5.45 5.11L2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z"
                                stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                        Feedback Inbox
                    </button>
                    <button class="tab @(activeTab == "campaigns" ? "active" : "")"
                        @onclick='() => SetActiveTab("campaigns")'>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"
                                stroke-linecap="round" stroke-linejoin="round" />
                            <polyline points="22,6 12,13 2,6" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                        Email Campaigns
                    </button>
                </div>
                <div class="filters">
                    <select class="filter-dropdown" @bind="selectedCategory">
                        <option value="">All Categories</option>
                        <option value="Service Quality">Service Quality</option>
                        <option value="Staff">Staff</option>
                        <option value="Facilities">Facilities</option>
                    </select>
                    <select class="filter-dropdown" @bind="selectedRating">
                        <option value="">All Ratings</option>
                        <option value="5">5 Stars</option>
                        <option value="4">4 Stars</option>
                        <option value="3">3 Stars</option>
                        <option value="2">2 Stars</option>
                        <option value="1">1 Star</option>
                    </select>
                </div>
            </div>

            @if (activeTab == "inbox")
            {
                <!-- Feedback Items -->
                <div class="feedback-list">
                    @foreach (var feedback in FilteredFeedbacks)
                    {
                        <div class="feedback-item">
                            <div class="feedback-avatar @feedback.AvatarClass">@feedback.Initials</div>
                            <div class="feedback-content">
                                <div class="feedback-top">
                                    <div class="feedback-author">
                                        <h3>@feedback.Name</h3>
                                        <div class="rating">
                                            @for (int i = 1; i <= 5; i++)
                                            {
                                                <span class="star @(i <= feedback.Rating ? "filled" : "")">★</span>
                                            }
                                            <span class="badge @feedback.BadgeClass">@feedback.BadgeText</span>
                                        </div>
                                    </div>
                                    <div class="feedback-right">
                                        <span class="feedback-date">@feedback.Date</span>
                                        @if (feedback.IsReplied)
                                        {
                                            <span class="status-badge replied">
                                                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                    stroke-width="3">
                                                    <polyline points="20 6 9 17 4 12" stroke-linecap="round"
                                                        stroke-linejoin="round" />
                                                </svg>
                                                Replied
                                            </span>
                                        }
                                    </div>
                                </div>
                                <p class="feedback-text">@feedback.Message</p>
                                <div class="feedback-actions">
                                    <button class="btn-action" @onclick="() => ReplyToFeedback(feedback.Id)">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                            stroke-width="2">
                                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"
                                                stroke-linecap="round" stroke-linejoin="round" />
                                        </svg>
                                        Reply
                                    </button>
                                    <button class="btn-action promo" @onclick="() => CreatePromo(feedback.Id)">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                            stroke-width="2">
                                            <path
                                                d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"
                                                stroke-linecap="round" stroke-linejoin="round" />
                                        </svg>
                                        Create Promo
                                    </button>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            }
            else
            {
                <!-- Email Campaigns -->
                <div class="campaigns-section">
                    <div class="campaign-header">
                        <h3>Email Campaigns</h3>
                        <button class="btn-primary" @onclick="CreateCampaign">
                            <span>+</span> Create Campaign
                        </button>
                    </div>
                    <div class="campaigns-grid">
                        @foreach (var campaign in campaigns)
                        {
                            <div class="campaign-card">
                                <div class="campaign-icon">
                                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#3b82f6"
                                        stroke-width="2">
                                        <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"
                                            stroke-linecap="round" stroke-linejoin="round" />
                                        <polyline points="22,6 12,13 2,6" stroke-linecap="round" stroke-linejoin="round" />
                                    </svg>
                                </div>
                                <h4>@campaign.Title</h4>
                                <div class="campaign-preview">
                                    @((MarkupString)campaign.Description)
                                </div>
                                <div class="campaign-stats">
                                    <div class="stat">
                                        <span class="stat-label">Sent</span>
                                        <span class="stat-value">@campaign.Sent</span>
                                    </div>
                                    <div class="stat">
                                        <span class="stat-label">Opened</span>
                                        <span class="stat-value">@campaign.Opened</span>
                                    </div>
                                    <div class="stat">
                                        <span class="stat-label">Clicked</span>
                                        <span class="stat-value">@campaign.Clicked</span>
                                    </div>
                                </div>
                                <div class="campaign-actions" style="display: flex; gap: 10px; margin-top: 15px;">
                                    <button class="btn-view" @onclick="() => ViewCampaign(campaign.Id)">View Details</button>
                                    <button class="btn-secondary" @onclick="() => ResendCampaign(campaign.Id)"
                                        style="padding: 8px 16px; font-size: 0.9em;">Resend</button>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            }
        </div>

        @if (showReplyModal)
        {
            <div class="modal-overlay" @onclick="CloseModal">
                <div class="modal-content" @onclick:stopPropagation>
                    <div class="modal-header">
                        <h3>Reply to Feedback</h3>
                        <button class="close-btn" @onclick="CloseModal">×</button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label>Your Response</label>
                            <textarea @bind="replyMessage" rows="5" placeholder="Type your response here..."></textarea>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn-secondary" @onclick="CloseModal">Cancel</button>
                        <button class="btn-primary" @onclick="SendReply">Send Reply</button>
                    </div>
                </div>
            </div>
        }

        @if (showPromoModal)
        {
            <div class="modal-overlay" @onclick="CloseModal">
                <div class="modal-content" @onclick:stopPropagation style="max-width: 600px;">
                    <div class="modal-header">
                        <h3>@(currentFeedbackId > 0 ? "Create Targeted Promo" : "Create Email Campaign")</h3>
                        <button class="close-btn" @onclick="CloseModal">×</button>
                    </div>
                    <div class="modal-body">
                        @if (currentFeedbackId == 0)
                        {
                            <div class="form-group">
                                <label>Select Audience</label>
                                <select @bind="selectedAudience" class="form-control"
                                    style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                                    <option>All Patients</option>
                                    <option>Patients with 4-5 Stars</option>
                                    <option>Recent Visitors (This Month)</option>
                                    <option>Inactive Patients (No visit in 6+ months)</option>
                                </select>
                            </div>
                        }

                        <div class="form-group">
                            <label>Email Subject</label>
                            <input type="text" @bind="promoTitle" placeholder="Enter email subject">
                        </div>

                        <div class="form-group">
                            <label>Email Content</label>
                            <textarea @bind="promoDescription" rows="5"
                                placeholder="Type your email content here..."></textarea>
                        </div>

                        <div class="form-group">
                            <label>Insert Image (Optional)</label>
                            <InputFile OnChange="HandleImageUpload" accept="image/*" class="form-control"
                                style="margin-top: 5px;" />
                            @if (!string.IsNullOrEmpty(uploadedImageUrl))
                            {
                                <div class="image-preview" style="margin-top: 10px;">
                                    <img src="@uploadedImageUrl" alt="Preview" style="max-height: 100px; border-radius: 4px;" />
                                </div>
                            }
                        </div>

                        <div class="form-group">
                            <label>Valid Until (for Promos)</label>
                            <input type="date" @bind="promoValidUntil">
                        </div>

                        <div class="quick-templates"
                            style="margin-top: 15px; border-top: 1px solid #eee; padding-top: 10px;">
                            <label style="display:block; margin-bottom: 5px; font-size: 0.9em; color: #666;">Quick
                                Templates</label>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn-secondary" @onclick='() => ApplyTemplate("Promotion")'>Promotion</button>
                                <button class="btn-secondary"
                                    @onclick='() => ApplyTemplate("Newsletter")'>Newsletter</button>
                                <button class="btn-secondary" @onclick='() => ApplyTemplate("Reminder")'>Reminder</button>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn-secondary" @onclick="CloseModal">Cancel</button>
                        <button class="btn-primary" @onclick="CreatePromoOffer" disabled="@isSending">
                            @(isSending ? "Sending..." : "Send Campaign")
                        </button>
                    </div>
                </div>
            </div>
        }
    </main>
</div>

@code {
    private string searchQuery = "";
    private string activeTab = "inbox";
    private string selectedCategory = "";
    private string selectedRating = "";
    private bool showReplyModal = false;
    private bool showPromoModal = false;
    private string replyMessage = "";
    private string promoTitle = "";
    private int promoDiscount = 0;
    private DateTime promoValidUntil = DateTime.Now.AddMonths(1);
    private string promoDescription = "";
    private int currentFeedbackId = 0;
    private bool isSending = false;

    // New fields for enhanced marketing
    private string selectedAudience = "All Patients";
    private IBrowserFile? selectedImageFile;
    private string uploadedImageUrl = "";
    private bool showSuccessMessage = false;

    private double averageRating = 0;
    private int happyPatients = 0;

    // UI Models
    public class FeedbackViewModel
    {
        public int Id { get; set; }
        public int PatientId { get; set; }
        public string Name { get; set; } = "";
        public string Email { get; set; } = "";
        public string Initials { get; set; } = "";
        public string AvatarClass { get; set; } = "";
        public int Rating { get; set; }
        public string BadgeText { get; set; } = "";
        public string BadgeClass { get; set; } = "";
        public string Date { get; set; } = "";
        public string Message { get; set; } = "";
        public bool IsReplied { get; set; }
    }

    public class CampaignViewModel
    {
        public int Id { get; set; }
        public string Title { get; set; } = "";
        public string Description { get; set; } = "";
        public int Sent { get; set; }
        public int Opened { get; set; }
        public int Clicked { get; set; }
        public string ImageUrl { get; set; } = "";
    }

    private List<FeedbackViewModel> feedbacks = new();
    private List<CampaignViewModel> campaigns = new();

    protected override async Task OnInitializedAsync()
    {
        await LoadData();
    }

    private async Task LoadData()
    {
        // Load Feedback
        var dbFeedbacks = await DatabaseService.GetAllFeedbackAsync();
        feedbacks = dbFeedbacks.Select(f => new FeedbackViewModel
        {
            Id = f.FeedbackID,
            PatientId = f.PatientID,
            Name = f.PatientName,
            Email = f.PatientEmail,
            Initials = GetInitials(f.PatientName),
            AvatarClass = GetAvatarClass(f.FeedbackID),
            Rating = f.Rating,
            BadgeText = GetBadgeText(f.Rating),
            BadgeClass = GetBadgeClass(f.Rating),
            Date = f.Date.ToString("MMM dd, yyyy"),
            Message = f.FeedbackText,
            IsReplied = f.IsReplied
        }).ToList();

        // Calculate Stats
        if (feedbacks.Any())
        {
            averageRating = feedbacks.Average(f => f.Rating);
            happyPatients = feedbacks.Count(f => f.Rating >= 4);
        }

        // Load Campaigns
        var dbCampaigns = await DatabaseService.GetCampaignsAsync();
        campaigns = dbCampaigns.Select(c => new CampaignViewModel
        {
            Id = c.CampaignID,
            Title = c.CampaignName,
            Description = c.Description,
            Sent = c.SentCount,
            Opened = 0, // Not tracking opens yet
            Clicked = 0, // Not tracking clicks yet
            ImageUrl = c.ImageUrl
        }).ToList();
    }

    private string GetInitials(string name)
    {
        if (string.IsNullOrEmpty(name)) return "??";
        var parts = name.Split(' ');
        if (parts.Length >= 2) return $"{parts[0][0]}{parts[1][0]}";
        return name.Substring(0, Math.Min(2, name.Length));
    }

    private string GetAvatarClass(int id)
    {
        var classes = new[] { "", "blue-avatar", "purple-avatar" };
        return classes[id % classes.Length];
    }

    private string GetBadgeText(int rating) => rating >= 5 ? "Excellent" : rating >= 4 ? "Good" : rating >= 3 ? "Average" :
    "Poor";
    private string GetBadgeClass(int rating) => rating >= 5 ? "excellent" : rating >= 4 ? "good" : rating >= 3 ? "average" :
    "poor";

    private IEnumerable<FeedbackViewModel> FilteredFeedbacks =>
    feedbacks.Where(f =>
    (string.IsNullOrEmpty(selectedRating) || f.Rating == int.Parse(selectedRating))
    );

    private void SetActiveTab(string tab) => activeTab = tab;
    private void ShowNotifications() => Console.WriteLine("Showing notifications...");
    private void OpenSettings() => Console.WriteLine("Opening settings...");

    private void NavigateTo(string url)
    {
        Navigation.NavigateTo(url);
    }
    private void ReplyToFeedback(int id)
    {
        currentFeedbackId = id;
        showReplyModal = true;
    }

    private void CreatePromo(int id)
    {
        currentFeedbackId = id;
        showPromoModal = true;
    }

    private void CloseModal()
    {
        showReplyModal = false;
        showPromoModal = false;
        replyMessage = "";
        promoTitle = "";
        promoDiscount = 0;
        promoDescription = "";
        isSending = false;
    }

    private async Task SendReply()
    {
        if (isSending) return;
        isSending = true;

        var feedback = feedbacks.FirstOrDefault(f => f.Id == currentFeedbackId);
        if (feedback != null && !string.IsNullOrEmpty(feedback.Email))
        {
            bool success = await EmailService.SendEmailAsync(
            feedback.Email,
            "Response to your feedback - Jade Dental Clinic",
            $"Dear {feedback.Name},<br/><br/>{replyMessage}<br/><br/>Best regards,<br/>Jade Dental Clinic"
            );

            if (success)
            {
                feedback.IsReplied = true;
            }
        }
        CloseModal();
    }

    private async Task HandleImageUpload(InputFileChangeEventArgs e)
    {
        selectedImageFile = e.File;
        // Optional: Upload immediately for preview
        try
        {
            uploadedImageUrl = await CloudinaryService.UploadImageAsync(selectedImageFile);
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Image upload failed: {ex.Message}");
            await JSRuntime.InvokeVoidAsync("alert", $"Image upload failed: {ex.Message}");
        }
    }

    private void ApplyTemplate(string type)
    {
        if (type == "Promotion")
        {
            promoTitle = "Special Offer Just for You!";
            promoDescription = "Dear Patient,\n\nThank you for being a valued member of our clinic. We are excited to offer you a special discount on your next visit!\n\n[Details Here]";
        }
        else if (type == "Newsletter")
        {
            promoTitle = "Monthly Dental Health Tips";
            promoDescription = "Dear Patient,\n\nHere are some tips to keep your smile bright this month:\n\n1. Brush twice a day.\n2. Floss daily.\n3. Visit us for a checkup!";
        }
        else if (type == "Reminder")
        {
            promoTitle = "Time for your Checkup?";
            promoDescription = "Dear Patient,\n\nIt's been a while since we saw you. Regular checkups are key to a healthy smile. Book your appointment today!";
        }
    }

    private async Task CreatePromoOffer()
    {
        if (isSending) return;
        isSending = true;

        // Upload image if not already uploaded
        if (selectedImageFile != null && string.IsNullOrEmpty(uploadedImageUrl))
        {
            try
            {
                uploadedImageUrl = await CloudinaryService.UploadImageAsync(selectedImageFile);
            }
            catch (Exception ex)
            {
                Console.WriteLine($"Image upload failed: {ex.Message}");
            }
        }

        // Construct Template with Image
        string imageHtml = !string.IsNullOrEmpty(uploadedImageUrl) ? $"<img src='{uploadedImageUrl}' style='max-width:100%; border-radius: 8px; margin-bottom: 15px;' /><br/>" : "";
        string contentHtml = promoDescription.Replace("\n", "<br/>");
        string fullTemplate = $"{imageHtml}{contentHtml}<br/><br/>Valid until: {promoValidUntil:MMM dd, yyyy}";

        // 1. Create Campaign in DB
        int campaignId = await DatabaseService.CreateMarketingCampaignAsync(promoTitle, fullTemplate, promoValidUntil,
        uploadedImageUrl);

        if (campaignId > 0)
        {
            List<PatientEmailModel> recipients = new();

            if (currentFeedbackId > 0)
            {
                // Single Patient (Targeted from Feedback)
                var feedback = feedbacks.FirstOrDefault(f => f.Id == currentFeedbackId);
                if (feedback != null) recipients.Add(new PatientEmailModel
                {
                    PatientID = feedback.PatientId,
                    Name = feedback.Name,
                    Email
                = feedback.Email
                });
            }
            else
            {
                // Audience Selection
                switch (selectedAudience)
                {
                    case "All Patients":
                        recipients = await DatabaseService.GetAllPatientsWithEmailAsync();
                        break;
                    case "Patients with 4-5 Stars":
                        recipients = await DatabaseService.GetPatientsByRatingAsync(4);
                        break;
                    case "Recent Visitors (This Month)":
                        recipients = await DatabaseService.GetRecentPatientsAsync(30);
                        break;
                    case "Inactive Patients (No visit in 6+ months)":
                        recipients = await DatabaseService.GetInactivePatientsAsync(6);
                        break;
                    default:
                        recipients = await DatabaseService.GetAllPatientsWithEmailAsync();
                        break;
                }
            }

            int sentCount = 0;
            foreach (var p in recipients)
            {
                if (string.IsNullOrEmpty(p.Email)) continue;

                bool sent = await EmailService.SendEmailAsync(
                p.Email,
                promoTitle,
                $"Dear {p.Name},<br/><br/>{fullTemplate}"
                );

                if (sent)
                {
                    await DatabaseService.RecordCampaignRecipientAsync(campaignId, p.PatientID);
                    sentCount++;
                }
            }

            await LoadData(); // Refresh list

            // Show Success
            await JSRuntime.InvokeVoidAsync("alert", $"Campaign '{promoTitle}' sent successfully to {sentCount} patients!");
        }
        CloseModal();
    }

    private void CreateCampaign()
    {
        currentFeedbackId = 0; // Reset for mass campaign
        showPromoModal = true;
    }

    private void ResendCampaign(int id)
    {
        var campaign = campaigns.FirstOrDefault(c => c.Id == id);
        if (campaign == null) return;

        currentFeedbackId = 0; // Mass campaign mode
        promoTitle = campaign.Title;
        uploadedImageUrl = campaign.ImageUrl;

        // Clean up description for editing
        string desc = campaign.Description;

        // Remove Image tag if present (it's usually at the start)
        // Regex to remove <img ... /> and following <br/>
        desc = System.Text.RegularExpressions.Regex.Replace(desc, @"<img[^>]*>(\s*<br\s*/?>)?", "",
        System.Text.RegularExpressions.RegexOptions.IgnoreCase);

        // Remove "Valid until" footer
        int validIndex = desc.LastIndexOf("Valid until:");
        if (validIndex > -1)
        {
            // Check for preceding <br/>s
            string beforeValid = desc.Substring(0, validIndex);
            desc = System.Text.RegularExpressions.Regex.Replace(beforeValid, @"(\s*<br\s*/?>\s*)+$", "",
            System.Text.RegularExpressions.RegexOptions.IgnoreCase);
        }

        // Convert BR to Newline for textarea
        promoDescription = System.Text.RegularExpressions.Regex.Replace(desc, @"<br\s*/?>", "\n",
        System.Text.RegularExpressions.RegexOptions.IgnoreCase).Trim();

        showPromoModal = true;
    }

    private void ViewCampaign(int id)
    {
        Console.WriteLine($"Viewing campaign {id}...");
    }
}