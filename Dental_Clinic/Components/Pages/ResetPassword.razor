@page "/reset-password"
@* Removed @inherits; markup will merge with partial class in .razor.cs *@

<div class="auth-container">
    <div class="left-section">
        <div class="clinic-logo">
            <div class="logo-placeholder">
                <img src="css/bootstrap/Dental_Logo.png" alt="Jade Dental Clinic Logo" class="clinic-logo-img" />
            </div>
            <h1>JADE DENTAL</h1>
            <h2 class="studio-text">CLINIC</h2>
            <p class="tagline">YOUR SMILE. OUR MASTERPIECE</p>
        </div>
        <div class="hero-content">
            <h2>Set a <span class="gradient-text">New Password</span></h2>
            <p class="hero-subtitle">Secure your account with a fresh password</p>
        </div>
    </div>

    <div class="right-section">
        <div class="auth-card">
            @if (passwordResetSuccessful)
            {
                <h3>Password Reset Successful</h3>
                <p class="auth-subtitle">Your password has been updated.</p>
                @if (!string.IsNullOrEmpty(successMessage))
                {
                    <div class="message-alert success">@successMessage</div>
                }
                <button class="primary-btn" type="button" @onclick="GoToLogin">Return to Login</button>
            }
            else
            {
                <h3>Reset Password</h3>
                <p class="auth-subtitle">Enter and confirm your new password</p>

                @if (!string.IsNullOrEmpty(errorMessage))
                {
                    <div class="message-alert error">@errorMessage</div>
                }
                @if (!string.IsNullOrEmpty(successMessage))
                {
                    <div class="message-alert success">@successMessage</div>
                }

                @if (string.IsNullOrEmpty(errorMessage))
                {
                    <EditForm Model="@resetPasswordModel" OnValidSubmit="HandleResetPassword">
                        <DataAnnotationsValidator />

                        <div class="input-field">
                            <label>New Password</label>
                            <div class="input-with-icon">
                                <svg class="icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                                    <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                                </svg>
                                <InputText type="@newPasswordType" @bind-Value="resetPasswordModel.NewPassword" placeholder="Enter new password" />
                                <button type="button" class="password-toggle" @onclick="ToggleNewPassword">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        @if (showNewPassword)
                                        {
                                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                                            <circle cx="12" cy="12" r="3" />
                                        }
                                        else
                                        {
                                            <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24" />
                                            <line x1="1" y1="1" x2="23" y2="23" />
                                        }
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <div class="input-field">
                            <label>Confirm Password</label>
                            <div class="input-with-icon">
                                <svg class="icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                                    <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                                </svg>
                                <InputText type="@confirmPasswordType" @bind-Value="resetPasswordModel.ConfirmPassword" placeholder="Confirm new password" />
                                <button type="button" class="password-toggle" @onclick="ToggleConfirmPassword">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        @if (showConfirmPassword)
                                        {
                                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                                            <circle cx="12" cy="12" r="3" />
                                        }
                                        else
                                        {
                                            <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24" />
                                            <line x1="1" y1="1" x2="23" y2="23" />
                                        }
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <button type="submit" class="primary-btn">
                            <span>Update Password</span>
                        </button>
                    </EditForm>
                }
                else
                {
                    <button type="button" class="primary-btn" @onclick="BackToLogin">Return to Login</button>
                }

                <button type="button" class="secondary-btn" style="margin-top:15px" @onclick="BackToLogin">Cancel</button>
            }
        </div>
    </div>
</div>
