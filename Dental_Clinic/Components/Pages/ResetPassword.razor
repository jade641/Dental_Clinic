@page "/reset-password"
@* Removed @inherits; markup will merge with partial class in .razor.cs *@

<link href="css/ForgotPass.css" rel="stylesheet" />

<div class="auth-container">
    <div class="left-section">
        <div class="clinic-branding">
            <div class="logo-container">
                <img src="css/bootstrap/Dental_Logo.png" alt="Jade Dental Clinic Logo" class="clinic-logo" />
            </div>
            <h1 class="clinic-title">AURELIA DENTAL CLINIC - DR JADE</h1>
            <p class="clinic-tagline">YOUR SMILE. OUR MASTERPIECE</p>
        </div>
        <div class="hero-section">
            <h2 class="hero-title">Set a <span class="highlight-text">New Password</span></h2>
            <p class="hero-subtitle">Secure your account with a fresh password</p>
        </div>
        <div class="stats-section">
            <div class="stat-item">
                <div class="stat-value">500+</div>
                <div class="stat-label">Happy Patients</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">15+</div>
                <div class="stat-label">Years Experience</div>
            </div>
        </div>
    </div>

    <div class="right-section">
        <div class="auth-card">
            @if (passwordResetSuccessful)
            {
                <div class="success-container">
                    <div class="success-icon">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2">
                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                            <polyline points="22 4 12 14.01 9 11.01"></polyline>
                        </svg>
                    </div>
                    <div class="form-header">
                        <h3>Password Reset Successful</h3>
                        <p>Your password has been updated.</p>
                    </div>
                    @if (!string.IsNullOrEmpty(successMessage))
                    {
                        <p class="success-description">@successMessage</p>
                    }
                    <button class="primary-btn" type="button" @onclick="GoToLogin">Return to Login</button>
                </div>
            }
            else
            {
                <div class="form-header">
                    <h3>Reset Password</h3>
                    <p>Enter and confirm your new password</p>
                </div>

                @if (!string.IsNullOrEmpty(errorMessage))
                {
                    <div class="error-message">@errorMessage</div>
                }
                @if (!string.IsNullOrEmpty(successMessage))
                {
                    <div class="error-message" style="background: #d1fae5; color: #065f46; border-color: #a7f3d0;">@successMessage</div>
                }

                @if (string.IsNullOrEmpty(errorMessage))
                {
                    <EditForm Model="@resetPasswordModel" OnValidSubmit="HandleResetPassword">
                        <DataAnnotationsValidator />

                        @if (string.IsNullOrEmpty(ResetToken))
                        {
                            <div class="input-field">
                                <label>Verification Code</label>
                                <div class="input-with-icon">
                                    <svg class="icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
                                    </svg>
                                    <InputText @bind-Value="resetPasswordModel.VerificationCode" placeholder="Enter 6-digit code" />
                                </div>
                            </div>
                        }

                        <div class="input-field">
                            <label>New Password</label>
                            <div class="input-with-icon">
                                <svg class="icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                                    <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                                </svg>
                                <InputText type="@newPasswordType" @bind-Value="resetPasswordModel.NewPassword"
                                    placeholder="Enter new password" />
                                <button type="button" class="password-toggle" @onclick="ToggleNewPassword" style="background:none; border:none; position:absolute; right:16px; top:50%; transform:translateY(-50%); cursor:pointer; color:#9ca3af;">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        @if (showNewPassword)
                                        {
                                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                                            <circle cx="12" cy="12" r="3" />
                                        }
                                        else
                                        {
                                            <path
                                                d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24" />
                                            <line x1="1" y1="1" x2="23" y2="23" />
                                        }
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <div class="input-field">
                            <label>Confirm Password</label>
                            <div class="input-with-icon">
                                <svg class="icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                                    <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                                </svg>
                                <InputText type="@confirmPasswordType" @bind-Value="resetPasswordModel.ConfirmPassword"
                                    placeholder="Confirm new password" />
                                <button type="button" class="password-toggle" @onclick="ToggleConfirmPassword" style="background:none; border:none; position:absolute; right:16px; top:50%; transform:translateY(-50%); cursor:pointer; color:#9ca3af;">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        @if (showConfirmPassword)
                                        {
                                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                                            <circle cx="12" cy="12" r="3" />
                                        }
                                        else
                                        {
                                            <path
                                                d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24" />
                                            <line x1="1" y1="1" x2="23" y2="23" />
                                        }
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <button type="submit" class="primary-btn">
                            <span>Update Password</span>
                        </button>
                    </EditForm>
                }
                else
                {
                    <button type="button" class="primary-btn" @onclick="BackToLogin">Return to Login</button>
                }

                <button type="button" class="btn-secondary" style="margin-top:15px" @onclick="BackToLogin">Cancel</button>
            }
        </div>
    </div>
</div>